<app-toolbar></app-toolbar>

<div class="pots-container">
  <div class="header-section">
    <h1 class="page-title">Mis Macetas</h1>
    <p class="subtitle">Monitorea y cuida tus plantas inteligentes</p>
  </div>

  <div class="content-wrapper">
    <div class="pots-header">
      <div class="header-info">
        <h2 class="section-title">{{ filteredPots.length }} macetas</h2>
        <p class="status-summary">
          {{ healthyCount }} saludables •
          {{ warningCount }} necesitan atención •
          {{ criticalCount }} críticas
        </p>
      </div>

      <div class="header-actions">
        <button mat-raised-button
                color="primary"
                class="add-pot-button"
                (click)="onAddPot()"
                [disabled]="isLoading">
          <mat-icon>add_circle</mat-icon>
          <span>Agregar Maceta</span>
        </button>
      </div>
    </div>

    <mat-tab-group
      class="pots-tabs"
      (selectedTabChange)="onTabChange($event.index)"
      animationDuration="200ms">

      <mat-tab label="Todas"></mat-tab>
      <mat-tab label="Saludables"></mat-tab>
      <mat-tab label="Necesitan atención"></mat-tab>
      <mat-tab label="Críticas"></mat-tab>
    </mat-tab-group>

    <div class="loading-container" *ngIf="isLoading">
      <p>Cargando macetas...</p>
    </div>

    <div class="error-container" *ngIf="errorMessage">
      <p>{{ errorMessage }}</p>
      <button mat-button (click)="loadPots()">Reintentar</button>
    </div>

    <div class="pots-grid" *ngIf="!isLoading && !errorMessage">
      <app-pot-card
        *ngFor="let pot of filteredPots"
        [pot]="pot"
        (waterPlant)="onWaterPlant($event)"
        (viewDetails)="onViewPotDetails($event)">
      </app-pot-card>

      <div *ngIf="filteredPots.length === 0 && !isLoading" class="no-pots">
        <mat-icon class="no-pots-icon">eco</mat-icon>
        <h3>{{ getEmptyStateTitle() }}</h3>
        <p>{{ getEmptyStateMessage() }}</p>
        <button mat-raised-button
                color="primary"
                (click)="onAddPot()"
                class="add-first-pot-button">
          <mat-icon>add_circle</mat-icon>
          {{ pots.length === 0 ? 'Agregar tu primera maceta' : 'Agregar nueva maceta' }}
        </button>
      </div>
    </div>
  </div>
</div>
